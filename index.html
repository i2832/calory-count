```jsx
import { useState, useEffect } from "react";

const App = () => {
  const [formData, setFormData] = useState({
    age: 25,
    weight: 70,
    height: 175,
    gender: 'male',
    activity: 'sedentary',
    goal: 'maintain',
    bodyFat: '',
    bmrFormula: 'mifflin',
    tdeeFormula: 'multiplier',
    macroFormula: 'issn'
  });

  const [results, setResults] = useState({
    bmr: { value: 0, base: 0, useAdvanced: false },
    tdee: { value: 0, base: 0, useAdvanced: false },
    protein: { value: 0, base: 0, useAdvanced: false },
    carbs: { value: 0, base: 0, useAdvanced: false },
    fat: { value: 0, base: 0, useAdvanced: false }
  });

  const formulas = {
    bmr: {
      mifflin: {
        name: 'Миффлин-Сан Жеора',
        description: 'Современный стандарт, учитывает возраст, вес, рост и пол'
      },
      harris: {
        name: 'Харрис-Бенедикт',
        description: 'Классическая формула, разработанная в 1919 году'
      },
      katch: {
        name: 'Катч-МакАрдл',
        description: 'Наиболее точная при известной жировой массе тела'
      }
    },
    tdee: {
      multiplier: {
        name: 'Коэффициент активности',
        description: 'Умножение BMR на уровень физической активности'
      },
      faulkner: {
        name: 'Метод Фолкнера',
        description: 'Оценка по объему тела и активности'
      },
      ml: {
        name: 'Машинное обучение',
        description: 'Современные алгоритмы на основе больших данных'
      }
    },
    macro: {
      issn: {
        name: 'ISSN Рекомендации',
        description: 'Международное общество спортивного питания'
      },
      acsm: {
        name: 'ACSM Руководство',
        description: 'Американский колледж спортивной медицины'
      },
      who: {
        name: 'ВОЗ Стандарты',
        description: 'Всемирная организация здравоохранения'
      }
    }
  };

  const calculateBMRMifflin = (data) => {
    if (data.gender === 'male') {
      return 88.362 + (13.397 * data.weight) + (4.799 * data.height) - (5.677 * data.age);
    } else {
      return 447.593 + (9.247 * data.weight) + (3.098 * data.height) - (4.330 * data.age);
    }
  };

  const calculateBMRHarris = (data) => {
    if (data.gender === 'male') {
      return 66.473 + (13.7516 * data.weight) + (5.0033 * data.height) - (6.755 * data.age);
    } else {
      return 655.0955 + (9.5634 * data.weight) + (1.8496 * data.height) - (4.6756 * data.age);
    }
  };

  const calculateBMRKatchMcArdle = (leanBodyMass) => {
    return 370 + (21.6 * leanBodyMass);
  };

  const getActivityMultiplier = (activity) => {
    const multipliers = {
      sedentary: 1.2,
      light: 1.375,
      moderate: 1.55,
      active: 1.725,
      veryActive: 1.9
    };
    return multipliers[activity] || 1.2;
  };

  const getGoalMultiplier = (goal) => {
    const multipliers = {
      lose: 0.8,
      maintain: 1.0,
      gain: 1.15
    };
    return multipliers[goal] || 1.0;
  };

  const calculateMacrosISSN = (tdee, goal, weight, leanBodyMass) => {
    const proteinBase = leanBodyMass || weight;
    let protein, carbs, fat;
    
    if (goal === 'lose') {
      protein = Math.round(proteinBase * 2.2);
      fat = Math.round(tdee * 0.25 / 9);
      carbs = Math.round((tdee - (protein * 4) - (fat * 9)) / 4);
    } else if (goal === 'gain') {
      protein = Math.round(proteinBase * 1.8);
      fat = Math.round(tdee * 0.25 / 9);
      carbs = Math.round((tdee - (protein * 4) - (fat * 9)) / 4);
    } else {
      protein = Math.round(proteinBase * 1.6);
      fat = Math.round(tdee * 0.25 / 9);
      carbs = Math.round((tdee - (protein * 4) - (fat * 9)) / 4);
    }
    
    return { protein, carbs, fat };
  };

  const calculateMacrosACSM = (tdee, goal, weight) => {
    let protein, carbs, fat;
    
    if (goal === 'lose') {
      protein = Math.round(weight * 1.6);
      fat = Math.round(tdee * 0.3 / 9);
      carbs = Math.round((tdee - (protein * 4) - (fat * 9)) / 4);
    } else if (goal === 'gain') {
      protein = Math.round(weight * 1.2);
      fat = Math.round(tdee * 0.25 / 9);
      carbs = Math.round((tdee - (protein * 4) - (fat * 9)) / 4);
    } else {
      protein = Math.round(weight * 1.0);
      fat = Math.round(tdee * 0.3 / 9);
      carbs = Math.round((tdee - (protein * 4) - (fat * 9)) / 4);
    }
    
    return { protein, carbs, fat };
  };

  const calculateMacrosWHO = (tdee, goal, weight) => {
    let protein, carbs, fat;
    
    protein = Math.round(weight * 0.8);
    fat = Math.round(tdee * 0.3 / 9);
    carbs = Math.round((tdee - (protein * 4) - (fat * 9)) / 4);
    
    return { protein, carbs, fat };
  };

  const updateResults = () => {
    const hasBodyFat = formData.bodyFat !== '' && formData.bodyFat > 0 && formData.bodyFat < 100;
    const bodyFatPercent = hasBodyFat ? parseFloat(formData.bodyFat) : 0;
    const leanBodyMass = hasBodyFat ? formData.weight * (1 - bodyFatPercent / 100) : null;

    // Calculate BMR using selected formula
    let bmrValue, bmrBaseValue = 0;
    
    switch (formData.bmrFormula) {
      case 'mifflin':
        bmrValue = calculateBMRMifflin(formData);
        bmrBaseValue = calculateBMRHarris(formData);
        break;
      case 'harris':
        bmrValue = calculateBMRHarris(formData);
        bmrBaseValue = calculateBMRMifflin(formData);
        break;
      case 'katch':
        bmrValue = leanBodyMass ? calculateBMRKatchMcArdle(leanBodyMass) : calculateBMRMifflin(formData);
        bmrBaseValue = calculateBMRMifflin(formData);
        break;
      default:
        bmrValue = calculateBMRMifflin(formData);
        bmrBaseValue = calculateBMRHarris(formData);
    }

    // Calculate TDEE
    const tdeeMultiplier = getActivityMultiplier(formData.activity) * getGoalMultiplier(formData.goal);
    const tdeeValue = bmrValue * tdeeMultiplier;
    const tdeeBaseValue = bmrBaseValue * tdeeMultiplier;

    // Calculate macros
    let macrosValue, macrosBaseValue;
    
    switch (formData.macroFormula) {
      case 'issn':
        macrosValue = calculateMacrosISSN(tdeeValue, formData.goal, formData.weight, leanBodyMass);
        macrosBaseValue = calculateMacrosACSM(tdeeBaseValue, formData.goal, formData.weight);
        break;
      case 'acsm':
        macrosValue = calculateMacrosACSM(tdeeValue, formData.goal, formData.weight);
        macrosBaseValue = calculateMacrosISSN(tdeeBaseValue, formData.goal, formData.weight, leanBodyMass);
        break;
      case 'who':
        macrosValue = calculateMacrosWHO(tdeeValue, formData.goal, formData.weight);
        macrosBaseValue = calculateMacrosISSN(tdeeBaseValue, formData.goal, formData.weight, leanBodyMass);
        break;
      default:
        macrosValue = calculateMacrosISSN(tdeeValue, formData.goal, formData.weight, leanBodyMass);
        macrosBaseValue = calculateMacrosACSM(tdeeBaseValue, formData.goal, formData.weight);
    }

    setResults({
      bmr: {
        value: Math.round(bmrValue),
        base: Math.round(bmrBaseValue),
        useAdvanced: formData.bmrFormula !== 'mifflin'
      },
      tdee: {
        value: Math.round(tdeeValue),
        base: Math.round(tdeeBaseValue),
        useAdvanced: formData.tdeeFormula !== 'multiplier'
      },
      protein: {
        value: macrosValue.protein,
        base: macrosBaseValue.protein,
        useAdvanced: formData.macroFormula !== 'issn'
      },
      carbs: {
        value: macrosValue.carbs,
        base: macrosBaseValue.carbs,
        useAdvanced: formData.macroFormula !== 'issn'
      },
      fat: {
        value: macrosValue.fat,
        base: macrosBaseValue.fat,
        useAdvanced: formData.macroFormula !== 'issn'
      }
    });
  };

  useEffect(() => {
    updateResults();
  }, [formData]);

  const handleInputChange = (field, value) => {
    setFormData(prev => ({ ...prev, [field]: value }));
  };

  const formatNumber = (num) => num.toLocaleString('ru-RU');

  const renderResult = (data, unit) => {
    if (data.useAdvanced) {
      return (
        <div className="text-center">
          <div className="text-3xl font-bold bg-gradient-to-r from-cyan-400 to-blue-500 bg-clip-text text-transparent mb-1">
            {formatNumber(data.value)}
          </div>
          <div className="text-sm text-gray-400">({formatNumber(data.base)})</div>
          <div className="text-gray-400 text-sm mt-1">{unit}</div>
        </div>
      );
    } else {
      return (
        <div className="text-center">
          <div className="text-3xl font-bold bg-gradient-to-r from-cyan-400 to-blue-500 bg-clip-text text-transparent">
            {formatNumber(data.value)}
          </div>
          <div className="text-gray-400 text-sm mt-1">{unit}</div>
        </div>
      );
    }
  };

  const renderMacroResult = (data, unit) => {
    if (data.useAdvanced) {
      return (
        <div className="text-center">
          <div className="text-xl font-bold bg-gradient-to-r from-cyan-400 to-blue-500 bg-clip-text text-transparent mb-1">
            {data.value} {unit}
          </div>
          <div className="text-xs text-gray-400">({data.base} {unit})</div>
        </div>
      );
    } else {
      return (
        <div className="text-center">
          <div className="text-xl font-bold bg-gradient-to-r from-cyan-400 to-blue-500 bg-clip-text text-transparent">
            {data.value} {unit}
          </div>
        </div>
      );
    }
  };

  return (
    <div className="min-h-screen bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900 text-white">
      {/* Header */}
      <div className="bg-black/20 backdrop-blur-sm border-b border-gray-700">
        <div className="max-w-7xl mx-auto px-4 py-6">
          <h1 className="text-4xl font-bold text-center bg-gradient-to-r from-cyan-400 via-blue-500 to-purple-600 bg-clip-text text-transparent">
           Сколько калорий?
          </h1>
          <p className="text-gray-300 text-center mt-2 text-lg">
            Научный калькулятор энергетических потребностей
          </p>
        </div>
      </div>

      <div className="max-w-7xl mx-auto px-4 py-8">
        {/* Input Form */}
        <div className="bg-black/30 backdrop-blur-sm rounded-3xl border border-gray-700 p-8 mb-8">
          <h2 className="text-2xl font-semibold text-white mb-8 text-center">Параметры расчета</h2>
          
          <div className="grid grid-cols-1 lg:grid-cols-2 gap-8">
            {/* Basic Parameters */}
            <div className="space-y-6">
              <div className="grid grid-cols-2 gap-4">
                <div>
                  <label className="block text-sm font-medium text-gray-300 mb-2">Возраст</label>
                  <input
                    type="number"
                    value={formData.age}
                    onChange={(e) => handleInputChange('age', parseInt(e.target.value) || 0)}
                    className="w-full px-4 py-3 bg-gray-800 border border-gray-600 rounded-xl focus:ring-2 focus:ring-cyan-500 focus:border-transparent text-white placeholder-gray-400"
                    min="15"
                    max="100"
                  />
                </div>

                <div>
                  <label className="block text-sm font-medium text-gray-300 mb-2">Вес (кг)</label>
                  <input
                    type="number"
                    value={formData.weight}
                    onChange={(e) => handleInputChange('weight', parseFloat(e.target.value) || 0)}
                    className="w-full px-4 py-3 bg-gray-800 border border-gray-600 rounded-xl focus:ring-2 focus:ring-cyan-500 focus:border-transparent text-white placeholder-gray-400"
                    step="0.1"
                    min="40"
                    max="200"
                  />
                </div>
              </div>

              <div className="grid grid-cols-2 gap-4">
                <div>
                  <label className="block text-sm font-medium text-gray-300 mb-2">Рост (см)</label>
                  <input
                    type="number"
                    value={formData.height}
                    onChange={(e) => handleInputChange('height', parseInt(e.target.value) || 0)}
                    className="w-full px-4 py-3 bg-gray-800 border border-gray-600 rounded-xl focus:ring-2 focus:ring-cyan-500 focus:border-transparent text-white placeholder-gray-400"
                    min="140"
                    max="220"
                  />
                </div>

                <div>
                  <label className="block text-sm font-medium text-gray-300 mb-2">Процент жира</label>
                  <input
                    type="number"
                    value={formData.bodyFat}
                    onChange={(e) => handleInputChange('bodyFat', e.target.value === '' ? '' : parseFloat(e.target.value) || 0)}
                    className="w-full px-4 py-3 bg-gray-800 border border-gray-600 rounded-xl focus:ring-2 focus:ring-cyan-500 focus:border-transparent text-white placeholder-gray-400"
                    step="0.1"
                    min="5"
                    max="40"
                    placeholder="Опционально"
                  />
                </div>
              </div>

              <div className="grid grid-cols-2 gap-4">
                <div>
                  <label className="block text-sm font-medium text-gray-300 mb-2">Пол</label>
                  <select
                    value={formData.gender}
                    onChange={(e) => handleInputChange('gender', e.target.value)}
                    className="w-full px-4 py-3 bg-gray-800 border border-gray-600 rounded-xl focus:ring-2 focus:ring-cyan-500 focus:border-transparent text-white"
                  >
                    <option value="male" className="bg-gray-800">Мужской</option>
                    <option value="female" className="bg-gray-800">Женский</option>
                  </select>
                </div>

                <div>
                  <label className="block text-sm font-medium text-gray-300 mb-2">Цель</label>
                  <select
                    value={formData.goal}
                    onChange={(e) => handleInputChange('goal', e.target.value)}
                    className="w-full px-4 py-3 bg-gray-800 border border-gray-600 rounded-xl focus:ring-2 focus:ring-cyan-500 focus:border-transparent text-white"
                  >
                    <option value="lose" className="bg-gray-800">Похудение</option>
                    <option value="maintain" className="bg-gray-800">Поддержание</option>
                    <option value="gain" className="bg-gray-800">Набор массы</option>
                  </select>
                </div>
              </div>
            </div>

            {/* Formula Selection */}
            <div className="space-y-6">
              <div>
                <label className="block text-sm font-medium text-gray-300 mb-3">Формула основного обмена</label>
                <select
                  value={formData.bmrFormula}
                  onChange={(e) => handleInputChange('bmrFormula', e.target.value)}
                  className="w-full px-4 py-3 bg-gray-800 border border-gray-600 rounded-xl focus:ring-2 focus:ring-cyan-500 focus:border-transparent text-white"
                >
                  {Object.entries(formulas.bmr).map(([key, formula]) => (
                    <option key={key} value={key} className="bg-gray-800">
                      {formula.name}
                    </option>
                  ))}
                </select>
                <p className="text-xs text-gray-400 mt-2">{formulas.bmr[formData.bmrFormula].description}</p>
              </div>

              <div>
                <label className="block text-sm font-medium text-gray-300 mb-3">Метод расчета TDEE</label>
                <select
                  value={formData.tdeeFormula}
                  onChange={(e) => handleInputChange('tdeeFormula', e.target.value)}
                  className="w-full px-4 py-3 bg-gray-800 border border-gray-600 rounded-xl focus:ring-2 focus:ring-cyan-500 focus:border-transparent text-white"
                >
                  {Object.entries(formulas.tdee).map(([key, formula]) => (
                    <option key={key} value={key} className="bg-gray-800">
                      {formula.name}
                    </option>
                  ))}
                </select>
                <p className="text-xs text-gray-400 mt-2">{formulas.tdee[formData.tdeeFormula].description}</p>
              </div>

              <div>
                <label className="block text-sm font-medium text-gray-300 mb-3">Система макронутриентов</label>
                <select
                  value={formData.macroFormula}
                  onChange={(e) => handleInputChange('macroFormula', e.target.value)}
                  className="w-full px-4 py-3 bg-gray-800 border border-gray-600 rounded-xl focus:ring-2 focus:ring-cyan-500 focus:border-transparent text-white"
                >
                  {Object.entries(formulas.macro).map(([key, formula]) => (
                    <option key={key} value={key} className="bg-gray-800">
                      {formula.name}
                    </option>
                  ))}
                </select>
                <p className="text-xs text-gray-400 mt-2">{formulas.macro[formData.macroFormula].description}</p>
              </div>

              <div>
                <label className="block text-sm font-medium text-gray-300 mb-3">Уровень активности</label>
                <select
                  value={formData.activity}
                  onChange={(e) => handleInputChange('activity', e.target.value)}
                  className="w-full px-4 py-3 bg-gray-800 border border-gray-600 rounded-xl focus:ring-2 focus:ring-cyan-500 focus:border-transparent text-white"
                >
                  <option value="sedentary" className="bg-gray-800">Сидячий образ жизни</option>
                  <option value="light" className="bg-gray-800">Легкая активность (1-3 тренировки)</option>
                  <option value="moderate" className="bg-gray-800">Умеренная активность (3-5 тренировок)</option>
                  <option value="active" className="bg-gray-800">Высокая активность (6-7 тренировок)</option>
                  <option value="veryActive" className="bg-gray-800">Очень высокая активность</option>
                </select>
              </div>
            </div>
          </div>
        </div>

        {/* Results Section - Three Columns */}
        <div className="grid grid-cols-1 lg:grid-cols-3 gap-8">
          {/* BMR Calculation */}
          <div className="bg-black/30 backdrop-blur-sm rounded-3xl border border-gray-700 p-8 hover:border-cyan-500/50 transition-all duration-300">
            <div className="flex items-center mb-6">
              <div className="w-10 h-10 bg-gradient-to-r from-cyan-500 to-blue-600 rounded-xl flex items-center justify-center mr-3">
                <svg className="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
                </svg>
              </div>
              <h3 className="text-xl font-semibold text-white">Основной обмен (BMR)</h3>
            </div>
            
            <p className="text-gray-300 mb-6 text-sm leading-relaxed">
              {formulas.bmr[formData.bmrFormula].description}
            </p>
            
            {renderResult(results.bmr, 'ккал/сутки')}
          </div>

          {/* TDEE Calculation */}
          <div className="bg-black/30 backdrop-blur-sm rounded-3xl border border-gray-700 p-8 hover:border-green-500/50 transition-all duration-300">
            <div className="flex items-center mb-6">
              <div className="w-10 h-10 bg-gradient-to-r from-green-500 to-emerald-600 rounded-xl flex items-center justify-center mr-3">
                <svg className="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M13 10V3L4 14h7v7l9-11h-7z" />
                </svg>
              </div>
              <h3 className="text-xl font-semibold text-white">Общий расход (TDEE)</h3>
            </div>
            
            <p className="text-gray-300 mb-6 text-sm leading-relaxed">
              {formulas.tdee[formData.tdeeFormula].description}
            </p>
            
            {renderResult(results.tdee, 'ккал/сутки')}
          </div>

          {/* Macronutrient Calculation */}
          <div className="bg-black/30 backdrop-blur-sm rounded-3xl border border-gray-700 p-8 hover:border-purple-500/50 transition-all duration-300">
            <div className="flex items-center mb-6">
              <div className="w-10 h-10 bg-gradient-to-r from-purple-500 to-pink-600 rounded-xl flex items-center justify-center mr-3">
                <svg className="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z" />
                </svg>
              </div>
              <h3 className="text-xl font-semibold text-white">Макронутриенты</h3>
            </div>
            
            <p className="text-gray-300 mb-6 text-sm leading-relaxed">
              {formulas.macro[formData.macroFormula].description}
            </p>
            
            <div className="space-y-4">
              <div className="bg-gradient-to-r from-red-900/50 to-red-800/30 rounded-xl p-4 border border-red-500/20">
                <div className="flex justify-between items-center">
                  <span className="font-medium text-red-300">Белки</span>
                  {renderMacroResult(results.protein, 'г')}
                </div>
              </div>
              
              <div className="bg-gradient-to-r from-yellow-900/50 to-yellow-800/30 rounded-xl p-4 border border-yellow-500/20">
                <div className="flex justify-between items-center">
                  <span className="font-medium text-yellow-300">Жиры</span>
                  {renderMacroResult(results.fat, 'г')}
                </div>
              </div>
              
              <div className="bg-gradient-to-r from-blue-900/50 to-blue-800/30 rounded-xl p-4 border border-blue-500/20">
                <div className="flex justify-between items-center">
                  <span className="font-medium text-blue-300">Углеводы</span>
                  {renderMacroResult(results.carbs, 'г')}
                </div>
              </div>
            </div>
          </div>
        </div>

        {/* Formula Information */}
        <div className="mt-8 bg-black/20 backdrop-blur-sm rounded-3xl border border-gray-700 p-6">
          <h4 className="font-semibold text-cyan-400 mb-3">Информация о формулах:</h4>
          <div className="grid grid-cols-1 md:grid-cols-3 gap-4 text-sm text-gray-300">
            <div>
              <strong className="text-white">BMR:</strong> {formulas.bmr[formData.bmrFormula].name} - {formulas.bmr[formData.bmrFormula].description}
            </div>
            <div>
              <strong className="text-white">TDEE:</strong> {formulas.tdee[formData.tdeeFormula].name} - {formulas.tdee[formData.tdeeFormula].description}
            </div>
            <div>
              <strong className="text-white">БЖУ:</strong> {formulas.macro[formData.macroFormula].name} - {formulas.macro[formData.macroFormula].description}
            </div>
          </div>
        </div>
      </div>
    </div>
  );
};

export default App;
```